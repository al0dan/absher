<!DOCTYPE html>
<html lang="ar" class="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مركز القيادة - أبشر أعمال</title>
    <link rel="stylesheet" href="/css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Strict Reset for Dashboard */
        * {
            box-sizing: border-box;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 2.5fr 1fr;
            /* Wider main area */
            gap: 25px;
            margin-bottom: 30px;
        }

        @media (max-width: 900px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Card Styles - Stricter Gov Style */
        .dash-card {
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            /* Sharper corners */
            padding: 20px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.03);
            /* Subtler shadow */
            margin-bottom: 20px;
            overflow: hidden;
            /* Prevent overflow */
        }

        .dash-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 12px;
        }

        .dash-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--business-theme-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Action Center - Refined */
        .action-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fffdf5;
            /* Very subtle yellow */
            border: 1px solid #ffeeba;
            border-right: 4px solid #ffbd2e;
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 4px;
        }

        .action-item:last-child {
            margin-bottom: 0;
        }

        /* Quick Actions Grid - No Emojis */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        @media (max-width: 600px) {
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .action-btn {
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 25px 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            color: #444;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }

        .action-btn:hover {
            border-color: var(--business-theme-color);
            background: #f8fbff;
            color: var(--business-theme-color);
            transform: translateY(-2px);
        }

        .action-icon-svg {
            width: 32px;
            height: 32px;
            stroke-width: 1.5;
            color: var(--business-theme-color);
        }

        /* Analytics */
        .analytics-row {
            display: flex;
            gap: 20px;
        }

        .stat-box {
            flex: 1;
            padding-right: 20px;
            border-right: 1px solid #eee;
        }

        .stat-box:first-child {
            padding-right: 0;
            border-right: none;
        }

        /* Table - No Emojis */
        .absher-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        .absher-table th {
            background: #f9f9f9;
            padding: 12px;
            text-align: right;
            color: #666;
            font-size: 13px;
            font-weight: 600;
            border-bottom: 1px solid #eee;
        }

        .absher-table td {
            padding: 14px 12px;
            border-bottom: 1px solid #eee;
            font-size: 14px;
            color: #333;
        }

        .absher-table tr:last-child td {
            border-bottom: none;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: bold;
        }

        .bg-green {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .bg-orange {
            background: #fff3e0;
            color: #ef6c00;
        }

        .type-icon {
            color: #777;
            width: 16px;
            height: 16px;
            vertical-align: middle;
            margin-left: 5px;
        }
    </style>
</head>

<body>
    <!-- Standard Header -->
    <header class="top-header">
        <div class="top-header-inner">
            <div class="header-left">
                <img src="/img/Absher_Business_logo.svg" alt="Absher" class="logo-absher" style="height: 80px;">
            </div>
            <div class="header-right">
                <div class="header-center">
                    <a id="switchLang" href="javascript:void(0);" class="lang-switch">
                        <span class="ar-text">English</span>
                        <span class="en-text">العربية</span>
                        <img src="/img/globe.svg" class="globe">
                    </a>
                </div>
                <a href="/logout"
                    style="color: #666; text-decoration: none; margin-left: 15px; font-weight: 500; display: flex; align-items: center; gap: 5px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                            d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                    <span>تسجيل الخروج</span>
                </a>
                <img src="/img/vission-logo.png" style="height:55px; margin-left:10px;">
                <img src="/img/moi-logo.svg" style="height:55px">
            </div>
        </div>
    </header>

    <main class="absher-form-section" style="max-width: 1300px; margin: 30px auto; padding: 0 25px;">

        <!-- Welcome & Breadcrumb -->
        <div
            style="display: flex; justify-content: space-between; align-items: end; margin-bottom: 25px; border-bottom: 1px solid #eee; padding-bottom: 15px;">
            <div>
                <div style="font-size: 12px; color: #888; margin-bottom: 8px;">الرئيسية > مركز القيادة</div>
                <h1 style="margin: 0; font-size: 26px; color: var(--business-theme-color);">أهلاً بك، {{ user.name }}
                </h1>
            </div>
            <div style="text-align: left;">
                <div style="font-size: 12px; color: #888;">حالة الحساب</div>
                <div
                    style="color: #2e7d32; font-weight: bold; display: flex; align-items: center; gap: 6px; font-size: 15px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
                        viewBox="0 0 16 16">
                        <path
                            d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                    </svg>
                    نشط - موثّق
                </div>
            </div>
        </div>

        <!-- 1. ALERT BAR (Full Width) -->
        {% if actions_required %}
        <div class="dash-card"
            style="border: 1px solid #ffcc80; background: #fff3e0; border-right: 5px solid #ef6c00; padding: 20px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
            <div style="display: flex; align-items: center; gap: 15px;">
                <div
                    style="background: #fff; padding: 10px; border-radius: 50%; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"
                        stroke="#ef6c00" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                    </svg>
                </div>
                <div>
                    <h3 style="margin: 0 0 5px 0; font-size: 18px; color: #d65c00;">إجراء مطلوب: توقيع عقد</h3>
                    <p style="margin: 0; font-size: 14px; color: #5d4037;">لديك <strong>{{ actions_required|length
                            }}</strong> عقد بانتظار توقيعك. يرجى إتمام الإجراء لتفعيل العقد.</p>
                </div>
            </div>
            <div>
                {% for action in actions_required[:1] %}
                <a href="/contract/{{ action.id }}" class="btn-absher"
                    style="background: #ef6c00; border: none; padding: 10px 30px; font-size: 14px; box-shadow: 0 4px 12px rgba(239, 108, 0, 0.2);">توقيع
                    الآن</a>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- 2. MAIN GRID -->
        <div class="dashboard-grid" style="grid-template-columns: 2.5fr 1fr; gap: 30px;">

            <!-- LEFT COLUMN (Main Content) -->
            <div>

                <!-- Financial Stats Row -->
                <div class="dash-card" style="padding: 25px;">
                    <div class="analytics-row">
                        <div class="stat-box">
                            <div style="font-size: 13px; color: #666; margin-bottom: 8px;">إجمالي قيمة العقود</div>
                            <div style="font-size: 32px; font-weight: 800; color: var(--business-theme-color);">{{
                                "{:,.2f}".format(total_value) }} <span
                                    style="font-size: 16px; font-weight: 500; color: #888;">ر.س</span></div>
                        </div>
                        <div class="stat-box" style="border-right: 1px solid #eee; padding-right: 30px;">
                            <div style="font-size: 13px; color: #666; margin-bottom: 8px;">العقود النشطة</div>
                            <div style="font-size: 32px; font-weight: 800; color: #333;">{{ status_stats.signed }}</div>
                        </div>
                        <div class="stat-box" style="border-right: 1px solid #eee; padding-right: 30px;">
                            <div style="font-size: 13px; color: #666; margin-bottom: 8px;">تحت الإجراء</div>
                            <div style="font-size: 32px; font-weight: 800; color: #ef6c00;">{{ status_stats.pending }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Services (High Visibility) -->
                <h3
                    style="color: #444; margin: 30px 0 15px; font-size: 18px; display: flex; align-items: center; gap: 10px;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M13 10V3L4 14h7v7l9-11h-7z" />
                    </svg>
                    الوصول السريع
                </h3>
                <div class="quick-actions" style="margin-bottom: 30px;">
                    <a href="/create?type=supply" class="action-btn">
                        <svg class="action-icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                        </svg>
                        <div>عقد توريد</div>
                    </a>
                    <a href="/create?type=service" class="action-btn">
                        <svg class="action-icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                        <div>عقد خدمات</div>
                    </a>
                    <a href="/create?type=nda" class="action-btn">
                        <svg class="action-icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                        </svg>
                        <div>عدم إفصاح</div>
                    </a>
                    <a href="/create?type=rental" class="action-btn">
                        <svg class="action-icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                        </svg>
                        <div>عقد إيجار</div>
                    </a>
                </div>

                <!-- Recent Contracts Table -->
                <div class="dash-card"
                    style="padding: 0; border: 1px solid #eee; box-shadow: 0 4px 15px rgba(0,0,0,0.04);">
                    <div class="dash-header" style="margin: 20px 25px 15px 25px; border-bottom: none;">
                        <div class="dash-title" style="font-size: 18px;">المعاملات الأخيرة</div>
                        <a href="#" style="font-size: 13px; color: var(--business-theme-color); font-weight: 600;">عرض
                            الأرشيف</a>
                    </div>
                    <table class="absher-table">
                        <thead>
                            <tr style="background: #fcfcfc;">
                                <th style="padding: 15px 25px;">رقم العقد</th>
                                <th>تاريخ الإنشاء</th>
                                <th>الطرف الثاني</th>
                                <th>القيمة</th>
                                <th>النوع</th>
                                <th>الحالة</th>
                                <th style="padding: 15px 25px;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for c in contracts[:5] %}
                            <tr style="transition: background 0.2s;" onmouseover="this.style.background='#fbfbfb'"
                                onmouseout="this.style.background='white'">
                                <td style="padding: 18px 25px; font-weight: bold; font-family: monospace; color: #555;">
                                    #{{ c.id }}</td>
                                <td style="color: #666; font-size: 13px;">12/12/2025</td> <!-- Demo Date -->
                                <td style="font-weight: 500;">{{ c.buyer }}</td>
                                <td style="font-weight: bold;">{{ "{:,.2f}".format(c.price) }}</td>
                                <td>
                                    {% if c.contract_type == 'supply' %}
                                    <span
                                        style="display:inline-flex; align-items:center; gap:5px; background:#e0f7fa; color:#006064; padding:4px 8px; border-radius:4px; font-size:12px;">
                                        <svg width="14" height="14" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                                        </svg> توريد
                                    </span>
                                    {% elif c.contract_type == 'service' %}
                                    <span
                                        style="display:inline-flex; align-items:center; gap:5px; background:#e8f5e9; color:#1b5e20; padding:4px 8px; border-radius:4px; font-size:12px;">
                                        <svg width="14" height="14" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                        </svg> خدمات
                                    </span>
                                    {% elif c.contract_type == 'nda' %}
                                    <span
                                        style="display:inline-flex; align-items:center; gap:5px; background:#fff8e1; color:#ff6f00; padding:4px 8px; border-radius:4px; font-size:12px;">
                                        <svg width="14" height="14" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                        </svg> NDA
                                    </span>
                                    {% else %}
                                    عام
                                    {% endif %}
                                </td>
                                <td>
                                    {% if c.signed_by_supplier and c.signed_by_buyer %}
                                    <span class="status-badge bg-green">مكتمل</span>
                                    {% else %}
                                    <span class="status-badge bg-orange">قيد الإجراء</span>
                                    {% endif %}
                                </td>
                                <td style="padding: 15px 25px;">
                                    <a href="/contract/{{ c.id }}"
                                        style="display: inline-block; padding: 8px 15px; border: 1px solid #ddd; border-radius: 6px; color: #444; font-size: 13px; font-weight: 500; text-decoration: none; transition: all 0.2s;">
                                        عرض
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                            {% if not contracts %}
                            <tr>
                                <td colspan="7" style="text-align: center; padding: 40px; color: #999;">لا توجد تعاملات
                                    حديثة. ابدأ بإنشاء عقد جديد.</td>
                            </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>

            </div>

            <!-- RIGHT COLUMN (Sidebar) -->
            <div>
                <!-- Create New - Prominent -->
                <div class="dash-card"
                    style="background: linear-gradient(145deg, var(--business-theme-color) 0%, #104a75 100%); color: white; border: none; padding: 30px 25px; box-shadow: 0 10px 30px rgba(0, 84, 131, 0.2);">
                    <h3
                        style="margin-top: 0; font-size: 22px; font-weight: 800; letter-spacing: -0.5px; margin-bottom: 10px;">
                        إنشاء عقد جديد</h3>
                    <p style="font-size: 14px; opacity: 0.9; margin-bottom: 30px; line-height: 1.6;">وثّق تعاملاتك
                        التجارية الآن بموثوقية وحماية قانونية.</p>
                    <a href="/create" class="btn-absher"
                        style="background: white; color: var(--business-theme-color); width: 100%; display: block; text-align: center; border: none; font-weight: 800; font-size: 16px; padding: 15px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">+
                        إنشاء عقد الآن</a>
                </div>

                <!-- Visuals - Muted Colors -->
                <div class="dash-card">
                    <div class="dash-title" style="font-size: 14px; margin-bottom: 15px; color: #666;">توزيع العقود
                    </div>
                    <div class="chart-container" style="height: 180px;">
                        <canvas id="typeChart"></canvas>
                    </div>
                </div>

                <div class="dash-card">
                    <div class="dash-title" style="font-size: 14px; margin-bottom: 15px; color: #666;">حالة التوقيع
                    </div>
                    <div class="chart-container" style="height: 180px;">
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>
            </div>

        </div>

    </main>

    <!-- Official Government Footer -->
    <footer class="absher-footer">
        <div class="footer-inner">
            <div class="footer-col" style="flex: 1.5;">
                <img src="/img/Absher_Business_logo.svg" alt="Absher"
                    style="height: 60px; margin-bottom: 20px; filter: grayscale(100%); opacity: 0.7;">
                <p style="color: #777; line-height: 1.8; font-size: 14px; max-width: 300px;">
                    منصة أبشر أعمال هي المنصة الرسمية لخدمات الأعمال الإلكترونية لوزارة الداخلية، وتهدف إلى تمكين
                    المنشآت من القيام بجميع التعاملات الحكومية إلكترونياً.
                </p>
            </div>

            <div class="footer-col" style="flex: 1;">
                <h4>خدمات المنصة</h4>
                <ul>
                    <li><a href="/service">توثيق العقود</a></li>
                    <li><a href="#">التفاويض الإلكترونية</a></li>
                    <li><a href="#">تأشيرات العمل</a></li>
                    <li><a href="#">تجديد السجلات</a></li>
                </ul>
            </div>

            <div class="footer-col" style="flex: 1;">
                <h4>المساعدة والدعم</h4>
                <ul>
                    <li><a href="#">الأسئلة الشائعة</a></li>
                    <li><a href="#">اتصل بنا (920020405)</a></li>
                    <li><a href="#">دليل المستخدم</a></li>
                    <li><a href="#">سياسة الخصوصية</a></li>
                </ul>
            </div>

            <div class="footer-col" style="flex: 1;">
                <h4>تطبيقات الجوال</h4>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button
                        style="background: #000; color: #fff; border:none; border-radius: 6px; padding: 8px 15px; display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                            viewBox="0 0 16 16">
                            <path
                                d="M8 1.018a.96.96 0 0 0-.279.12l-5.69 3.284a1.002 1.002 0 0 0 0 1.737l5.69 3.284a.96.96 0 0 0 .558 0l5.69-3.284a1.002 1.002 0 0 0 0-1.737L8.279 1.138A.96.96 0 0 0 8 1.018z" />
                        </svg>
                        <span style="font-family: sans-serif; font-size: 12px;">App Store</span>
                    </button>
                    <button
                        style="background: #000; color: #fff; border:none; border-radius: 6px; padding: 8px 15px; display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                            viewBox="0 0 16 16">
                            <path
                                d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zM4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z" />
                        </svg>
                        <span style="font-family: sans-serif; font-size: 12px;">Google Play</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="footer-bottom">
            <div>جميع الحقوق محفوظة © أبشر أعمال 2024 - وزارة الداخلية</div>
            <div style="display: flex; gap: 20px;">
                <img src="/img/vission-logo.png" style="height: 35px; filter: grayscale(100%); opacity: 0.6;">
                <img src="/img/moi-logo.svg" style="height: 35px; filter: grayscale(100%); opacity: 0.6;">
            </div>
        </div>
    </footer>

    <script>
        // Charts Data - Muted Colors
        const typeData = {{ type_stats| tojson }};
        const statusData = {{ status_stats| tojson }};

        // Type Chart
        new Chart(document.getElementById('typeChart'), {
            type: 'doughnut',
            data: {
                labels: ['توريد', 'خدمات', 'NDA', 'عام'],
                datasets: [{
                    data: [typeData.supply, typeData.service, typeData.nda, (typeData.rental + (typeData.general || 0))],
                    // Muted Palette: Teal, Blue-Grey, Amber, Brown
                    backgroundColor: ['#4db6ac', '#90a4ae', '#ffd54f', '#a1887f'],
                    borderWidth: 0,
                    cutout: '70%'
                }]
            },
            options: {
                plugins: { legend: { display: false } },
                maintainAspectRatio: false
            }
        });

        // Status Chart - De-emphasized
        new Chart(document.getElementById('statusChart'), {
            type: 'doughnut', // Switch to doughnut for less visual weight
            data: {
                labels: ['مكتمل', 'معلق'],
                datasets: [{
                    data: [statusData.signed, statusData.pending],
                    // Muted Green, Muted Orange
                    backgroundColor: ['#81c784', '#ffb74d'],
                    borderWidth: 0,
                    cutout: '60%'
                }]
            },
            options: {
                plugins: { legend: { position: 'bottom', labels: { boxWidth: 12, usePointStyle: true, font: { size: 12, family: "'DINNextArabic', sans-serif" } } } },
                maintainAspectRatio: false
            }
        });

        // Lang Switch logic
        const switchLang = document.getElementById('switchLang');
        if (switchLang) {
            switchLang.addEventListener('click', () => {
                const html = document.documentElement;
                if (html.lang === 'ar') {
                    html.lang = 'en'; html.classList.remove('rtl'); html.classList.add('ltr');
                } else {
                    html.lang = 'ar'; html.classList.remove('ltr'); html.classList.add('rtl');
                }
            });
        }
    </script>
</body>

</html>